TODO write tests for each functions
